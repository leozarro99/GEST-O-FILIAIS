<!-- index.html -->
<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>TERC SISTEMAS</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Inter', sans-serif;
    }
  </style>
</head>
<body class="bg-gray-100">
  <div id="root"></div>

  <!-- Scripts -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.43.0/dist/umd/supabase.min.js"></script>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script type="text/javascript">
    const { useState } = React;
    const supabase = window.supabase.createClient(
      'https://gfivmnnysomfwrffybeh.supabase.co',
      'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImdmaXZtbm55c29tZndyZmZ5YmVoIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTMyOTY3NjgsImV4cCI6MjA2ODg3Mjc2OH0.NxetXJoCLh4q9zAqn_olimziI3YP4MAJzB8ed4qf8cg'
    );

    const Header = ({ username, onLogout }) => (
      React.createElement("header", { className: "bg-white shadow p-4 flex justify-between items-center" },
        React.createElement("h1", { className: "text-xl font-bold text-blue-600" }, "TERC SISTEMAS"),
        React.createElement("div", { className: "flex items-center gap-4" },
          React.createElement("span", { className: "text-gray-700" }, `Olá, ${username}`),
          React.createElement("button", { onClick: onLogout, className: "bg-red-500 text-white px-4 py-2 rounded-md hover:bg-red-600" }, "Sair")
        )
      )
    );

    const Footer = () => (
      React.createElement("footer", { className: "bg-white text-center py-4 text-sm text-gray-500 mt-auto" },
        `© ${new Date().getFullYear()} TERC SISTEMAS - Todos os direitos reservados.`
      )
    );

    const Layout = ({ userId, userRole, showToast }) => {
      const [currentPage, setCurrentPage] = useState('equipamentos');
      return React.createElement("div", { className: "min-h-screen flex" },
        React.createElement("aside", { className: "w-64 bg-white shadow-md" },
          React.createElement("div", { className: "p-4 font-bold text-blue-600 border-b" }, "Menu"),
          React.createElement("nav", { className: "flex flex-col gap-2 p-4" },
            React.createElement("button", { onClick: () => setCurrentPage('equipamentos'), className: "text-left hover:text-blue-600" }, "Equipamentos"),
            React.createElement("button", { onClick: () => setCurrentPage('filiais'), className: "text-left hover:text-blue-600" }, "Filiais"),
            userRole === 'administrador' &&
              React.createElement("button", { onClick: () => setCurrentPage('usuarios'), className: "text-left hover:text-blue-600" }, "Usuários")
          )
        ),
        React.createElement("main", { className: "flex-1 p-6" },
          currentPage === 'equipamentos' && React.createElement("div", { className: "text-gray-700" }, "Gerenciamento de Equipamentos"),
          currentPage === 'filiais' && React.createElement("div", { className: "text-gray-700" }, "Gerenciamento de Filiais"),
          currentPage === 'usuarios' && userRole === 'administrador' && React.createElement("div", { className: "text-gray-700" }, "Gerenciamento de Usuários")
        )
      );
    };

    const LoginPage = ({ onLogin }) => {
      const [username, setUsername] = useState('');
      const [password, setPassword] = useState('');
      const [error, setError] = useState('');

      const handleLogin = async (e) => {
        e.preventDefault();
        if (!username || !password) {
          setError('Preencha todos os campos.');
          return;
        }

        const { data, error: loginError } = await supabase
          .from('app_users')
          .select('*')
          .eq('username', username.toLowerCase())
          .eq('password', password);

        if (loginError || !data || data.length === 0) {
          setError('Usuário ou senha inválidos.');
        } else {
          const user = data[0];
          localStorage.setItem('userId', user.username);
          localStorage.setItem('userRole', user.role);
          onLogin(user.role, user.username);
        }
      };

      return React.createElement("div", { className: "min-h-screen flex items-center justify-center bg-gray-100" },
        React.createElement("form", { onSubmit: handleLogin, className: "bg-white p-8 rounded-xl shadow-md w-full max-w-sm" },
          React.createElement("h2", { className: "text-2xl font-bold text-blue-600 text-center mb-6" }, "TERC SISTEMAS"),
          error && React.createElement("div", { className: "bg-red-100 border border-red-400 text-red-700 p-2 rounded mb-4 text-sm" }, error),
          React.createElement("input", {
            type: "text",
            value: username,
            onChange: e => setUsername(e.target.value),
            placeholder: "Usuário",
            className: "w-full mb-4 px-4 py-2 border rounded focus:outline-none focus:ring"
          }),
          React.createElement("input", {
            type: "password",
            value: password,
            onChange: e => setPassword(e.target.value),
            placeholder: "Senha",
            className: "w-full mb-4 px-4 py-2 border rounded focus:outline-none focus:ring"
          }),
          React.createElement("button", {
            type: "submit",
            className: "w-full bg-blue-600 hover:bg-blue-700 text-white py-2 rounded transition"
          }, "Entrar")
        )
      );
    };

    function App() {
      const [userRole, setUserRole] = useState(localStorage.getItem('userRole') || null);
      const [userId, setUserId] = useState(localStorage.getItem('userId') || null);

      const handleLogin = (role, username) => {
        setUserRole(role);
        setUserId(username);
      };

      const handleLogout = () => {
        localStorage.clear();
        setUserRole(null);
        setUserId(null);
      };

      const showToast = (msg, type) => {
        alert(`${type === 'error' ? 'Erro' : 'Sucesso'}: ${msg}`);
      };

      return userRole ? (
        React.createElement("div", { className: "flex flex-col min-h-screen" },
          React.createElement(Header, { username: userId, onLogout: handleLogout }),
          React.createElement(Layout, { userId, userRole, showToast }),
          React.createElement(Footer, null)
        )
      ) : (
        React.createElement(LoginPage, { onLogin: handleLogin })
      );
    }

    ReactDOM.render(React.createElement(App), document.getElementById("root"));
  </script>
</body>
</html>
